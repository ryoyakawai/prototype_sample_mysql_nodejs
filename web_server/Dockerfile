FROM node:10

ARG WORK_DIR
ARG WEB_PORT
ARG DATABASE_HOST
ARG DATABASE_PORT
ARG DATABASE_USER_NAME
ARG DATABASE_USER_PASSWORD
ARG DATABASE_NAME

ENV WORKDIR $WORK_DIR
ENV WEB_PORT $WEB_PORT
ENV DATABASE_HOST $DATABASE_HOST
ENV DATABASE_PORT $DATABASE_PORT
ENV DATABASE_USER_NAME $DATABASE_USER_NAME
ENV DATABASE_USER_PASSWORD $DATABASE_USER_PASSWORD
ENV DATABASE_NAME $DATABASE_NAME

WORKDIR /usr/src/app

COPY package.json ./
COPY package-lock.json ./

RUN npm install

COPY . .

# set ENV(in Dockerfile) and ARG(in Container)
ENV WEB_PORT $WEB_PORT

EXPOSE $WEB_PORT
CMD [ "npm", "run", "start"]
